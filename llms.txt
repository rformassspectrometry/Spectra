# Low level infrastructure to handle MS spectra

[![Project Status: Active – The project has reached a stable, usable
state and is being actively
developed.](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)
[![R-CMD-check-bioc](https://github.com/RforMassSpectrometry/Spectra/workflows/R-CMD-check-bioc/badge.svg)](https://github.com/RforMassSpectrometry/Spectra/actions?query=workflow%3AR-CMD-check-bioc)
[![codecov](https://codecov.io/gh/rformassspectrometry/Spectra/branch/main/graph/badge.svg?token=jy0Mid9gKn)](https://codecov.io/gh/rformassspectrometry/Spectra)
[![license](https://img.shields.io/badge/license-Artistic--2.0-brightgreen.svg)](https://opensource.org/licenses/Artistic-2.0)
[![years in
bioc](http://bioconductor.org/shields/years-in-bioc/Spectra.svg)](https://bioconductor.org/packages/release/bioc/html/Spectra.html)
[![Ranking by
downloads](http://bioconductor.org/shields/downloads/release/Spectra.svg)](https://bioconductor.org/packages/stats/bioc/Spectra/)
[![build
release](http://bioconductor.org/shields/build/release/bioc/Spectra.svg)](https://bioconductor.org/checkResults/release/bioc-LATEST/Spectra/)
[![build
devel](http://bioconductor.org/shields/build/devel/bioc/Spectra.svg)](https://bioconductor.org/checkResults/devel/bioc-LATEST/Spectra/)

The *Spectra* package defines an efficient infrastructure for storing
and handling mass spectrometry spectra and functionality to subset,
process, visualize and compare spectra data.

A description of its functionality and design is available in this
[preprint](https://doi.org/10.31219/osf.io/cwt2v_v2).

*Spectra* provides different implementations (backends) to store mass
spectrometry data. These comprise backends tuned for fast data access
and processing and backends for very large data sets ensuring a small
memory footprint.

A (possibly incomplete) list of available backends (along with a link to
the R package providing it) is shown below:

- `MsBackendCompDb` (package
  [*CompoundDb*](https://github.com/rformassspectrometry/CompoundDb):
  provides access to spectra data (spectra and peaks variables) from a
  *CompDb* database. Has a small memory footprint because all data
  (except precursor m/z values) are retrieved on-the-fly from the
  database.

- `MsBackendDataFrame` (package: *Spectra*): alternative to the
  `MsBackendMemory` also keeping all data in memory, but supporting `S4`
  objects as spectra variables because the data is stored internally in
  a `DataFrame`.

- `MsBackendHdf5Peaks` (package: *Spectra*): on-disk backend similar to
  `MsBackendMzR`, but the peaks data is stored in HDF5 files (general
  spectra variables are kept in memory).

- `MsBackendHmdbXml` (package
  [*MsbackendHmdb*](https://github.com/rformassspectrometry/MsBackendHmdb)):
  allows import of MS data from xml files of the Human Metabolome
  Database (HMDB). Extends the `MsBackendDataFrame` and keeps thus all
  data, after import, in memory.

- `MsBackendMassbank` (package
  [*MsBackendMassbank*](https://github.com/rformassspectrometry/MsBackendMassbank)):
  allows to import/export data in MassBank text file format. Extends the
  `MsBackendDataFrame` and keeps thus all data, after import, in memory.

- `MsBackendMassbankSql` (package
  [*MsBackendMassbank*](https://github.com/rformassspectrometry/MsBackendMassbank)):
  allows to directly connect to a MassBank SQL database to retrieve all
  MS data and variables. Has a minimal memory footprint because all data
  is retrieved on-the-fly from the SQL database.

- `MsBackendMemory` (package: *Spectra*): *default* backend which keeps
  all data in memory. Optimized for fast processing.

- `MsBackendMetaboLights` (package
  [*MsBackendMetaboLights*](https://github.com/rformassspectrometry/MsBackendMetaboLights)):
  retrieves and caches MS data files from MetaboLights.

- `MsBackendMgf` (package
  [*MsBackendMgf*](https://github.com/rformassspectrometry/MsBackendMgf)):
  allows to import/export data in mascot generic format (MGF). Extends
  the `MsBackendDataFrame` and keeps thus all data, after import, in
  memory.

- `MsBackendMsp` (package
  [*MsbackendMsp*](https://github.com/rformassspectrometry/MsBackendMsp)):
  allows to import/export data in NIST MSP format. Extends the
  `MsBackendDataFrame` and keeps thus all data, after import, in memory.

- `MsBackendMzR` (package: *Spectra*): by using the `mzR` package it
  supports import of MS data from mzML, mzXML and CDF files. This
  backend keeps only general spectra variables in memory and retrieves
  the peaks data (m/z and intensity values) on-the-fly from the original
  data files. The backend has thus a smaller memory footprint compared
  to in-memory backends.

- `MsBackendOfflineSql` (package
  [*MsBackendSql*](https://github.com/rformassspectrometry/MsBackendSql)):
  stores all MS data in a SQL database and has thus a minimal memory
  footprint. Does, in contrast to `MsBackendSql`, not keep an active SQL
  database connection and can thus support parallel processing.

- `MsBackendRawFileReader` (package
  [*MsBackendRawFileReader*](https://github.com/fgcz/MsBackendRawFileReader)):
  implements a backend for reading MS data from Thermo Fisher
  Scientific’s raw data files using the manufacturer’s NewRawFileReader
  .Net libraries. The package generalizes the functionality introduced
  by the `rawrr` package.

- `MsBackendSql` (package
  [*MsBackendSql*](https://github.com/rformassspectrometry/MsBackendSql)):
  stores all MS data in a SQL database and has thus a minimal memory
  footprint.

- `MsBackendTimsTof` (package
  [*MsBackendTimsTof*](https://github.com/rformassspectrometry/MsBackendTimsTof):
  allows import of data from Bruker TimsTOF raw data files (using the
  `opentimsr` R package).

- `MsBackendWeizMass` (package
  [*MsBackendWeizMass*](https://github.com/rformassspectrometry/MsBackendWeizMass):
  allows to access MS data from WeizMass MS/MS spectral databases.

For more information see the package
[homepage](https://rformassspectrometry.github.io/Spectra).

# Installation

The package can be installed with

``` r

install.packages("BiocManager")
BiocManager::install("Spectra")
```

# Contributions

Contributions are highly welcome and should follow the [contribution
guidelines](https://rformassspectrometry.github.io/RforMassSpectrometry/articles/RforMassSpectrometry.html#contributions).
Also, please check the coding style guidelines in the
[RforMassSpectrometry
vignette](https://rformassspectrometry.github.io/RforMassSpectrometry/articles/RforMassSpectrometry.html)
and importantly, follow our [code of
conduct](https://rformassspectrometry.github.io/RforMassSpectrometry/articles/RforMassSpectrometry.html#code-of-conduct).

# Package index

## All functions

- [`backendBpparam(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`backendInitialize(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`backendMerge(`*`<list>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`backendMerge(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`backendParallelFactor(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`export(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`acquisitionNum(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`peaksData(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`peaksVariables(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`cbind2(`*`<MsBackend>`*`,`*`<dataframeOrDataFrameOrmatrix>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`centroided(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `centroided<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`collisionEnergy(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `collisionEnergy<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`dataOrigin(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `dataOrigin<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`dataStorage(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `dataStorage<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`dropNaSpectraVariables(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`extractByIndex(`*`<MsBackend>`*`,`*`<ANY>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`extractByIndex(`*`<MsBackend>`*`,`*`<missing>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterAcquisitionNum(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterDataOrigin(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterDataStorage(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterEmptySpectra(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterIsolationWindow(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterMsLevel(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterPolarity(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterPrecursorMzRange(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterPrecursorMz(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterPrecursorMzValues(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterPrecursorCharge(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterPrecursorScan(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterRanges(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterRt(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`filterValues(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`intensity(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `intensity<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`ionCount(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`isCentroided(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`isEmpty(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`isolationWindowLowerMz(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `isolationWindowLowerMz<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`isolationWindowTargetMz(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `isolationWindowTargetMz<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`isolationWindowUpperMz(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `isolationWindowUpperMz<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`isReadOnly(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`length(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`msLevel(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `msLevel<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`mz(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `mz<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`lengths(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`polarity(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `polarity<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`precScanNum(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`precursorCharge(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`precursorIntensity(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`precursorMz(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `precursorMz<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `peaksData<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`reset(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`rtime(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `rtime<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`scanIndex(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`selectSpectraVariables(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`smoothed(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `smoothed<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`spectraData(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `spectraData<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`spectraNames(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `spectraNames<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`spectraVariables(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`split(`*`<MsBackend>`*`,`*`<ANY>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`supportsSetBackend(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`tic(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `[`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `$`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `$<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `[[`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `[[<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`uniqueMsLevels(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`dataStorageBasePath(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`` `dataStorageBasePath<-`( ``*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`longForm(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`MsBackendDataFrame()`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`backendInitialize(`*`<MsBackendDataFrame>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`MsBackendHdf5Peaks()`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`MsBackendMemory()`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`backendInitialize(`*`<MsBackendMemory>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  [`MsBackendMzR()`](https://rformassspectrometry.github.io/Spectra/reference/MsBackend.md)
  : Mass spectrometry data backends

- [`MsBackendCached()`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`backendInitialize(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`dataStorage(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`extractByIndex(`*`<MsBackendCached>`*`,`*`<ANY>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`length(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`spectraVariables(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`spectraData(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`` `spectraData<-`( ``*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`` `[`( ``*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`` `$`( ``*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`` `$<-`( ``*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`selectSpectraVariables(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`show(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`intensity(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`ionCount(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  [`mz(`*`<MsBackendCached>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/MsBackendCached.md)
  : Base MsBackend class providing data caching mechanism

- [`Spectra(`*`<missing>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  [`Spectra(`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  [`Spectra(`*`<character>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  [`Spectra(`*`<ANY>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  [`setBackend(`*`<Spectra>`*`,`*`<MsBackend>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  [`export(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  [`dataStorageBasePath(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  [`` `dataStorageBasePath<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/Spectra.md)
  : The Spectra class to manage and access MS data

- [`processingLog()`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`scalePeaks()`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`addProcessing(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`applyProcessing(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`bin(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`containsMz(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`containsNeutralLoss(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`entropy(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`entropy(`*`<ANY>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`pickPeaks(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`replaceIntensitiesBelow(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`reset(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`smooth(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  [`spectrapply(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/addProcessing.md)
  : Data manipulation and analysis methods

- [`chunkapply()`](https://rformassspectrometry.github.io/Spectra/reference/chunkapply.md)
  : Apply a function stepwise to chunks of data

- [`combinePeaks(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/combinePeaks.md)
  : Aggregating and combining mass peaks data

- [`combinePeaksData()`](https://rformassspectrometry.github.io/Spectra/reference/combinePeaksData.md)
  : Combine peaks with similar m/z across spectra

- [`concatenateSpectra()`](https://rformassspectrometry.github.io/Spectra/reference/combineSpectra.md)
  [`combineSpectra()`](https://rformassspectrometry.github.io/Spectra/reference/combineSpectra.md)
  [`joinSpectraData()`](https://rformassspectrometry.github.io/Spectra/reference/combineSpectra.md)
  [`c(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/combineSpectra.md)
  [`cbind2(`*`<Spectra>`*`,`*`<dataframeOrDataFrameOrmatrix>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/combineSpectra.md)
  [`split(`*`<Spectra>`*`,`*`<ANY>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/combineSpectra.md)
  : Merging, aggregating and splitting Spectra

- [`compareSpectra(`*`<Spectra>`*`,`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/compareSpectra.md)
  [`compareSpectra(`*`<Spectra>`*`,`*`<missing>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/compareSpectra.md)
  : Spectra similarity calculations

- [`countIdentifications()`](https://rformassspectrometry.github.io/Spectra/reference/countIdentifications.md)
  : Count the number of identifications per scan

- [`estimatePrecursorIntensity(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/estimatePrecursorIntensity.md)
  : Estimate Precursor Intensities

- [`estimatePrecursorMz()`](https://rformassspectrometry.github.io/Spectra/reference/estimatePrecursorMz.md)
  : Estimating precursor m/z valus for DDA data

- [`fillCoreSpectraVariables()`](https://rformassspectrometry.github.io/Spectra/reference/fillCoreSpectraVariables.md)
  : Fill spectra data with columns for missing core variables

- [`filterFourierTransformArtefacts`](https://rformassspectrometry.github.io/Spectra/reference/filterFourierTransformArtefacts.md)
  [`fft_spectrum`](https://rformassspectrometry.github.io/Spectra/reference/filterFourierTransformArtefacts.md)
  : Fast fourier transform artefact filter

- [`deisotopeSpectra()`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`reduceSpectra()`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorMaxIntensity()`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorIsotopes()`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorPeaks()`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`dropNaSpectraVariables(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`selectSpectraVariables(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`` `[`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterAcquisitionNum(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterEmptySpectra(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterDataOrigin(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterDataStorage(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterFourierTransformArtefacts(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterIntensity(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterIsolationWindow(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterMsLevel(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterMzRange(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterMzValues(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPolarity(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorMz(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorMzRange(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorMzValues(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorCharge(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterPrecursorScan(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterRt(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterRanges(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  [`filterValues(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/filterMsLevel.md)
  : Filter and subset Spectra objects

- [`filterPeaksRanges()`](https://rformassspectrometry.github.io/Spectra/reference/filterPeaksRanges.md)
  : Filter peaks based on spectra and peaks variable ranges

- [`fragmentGroupIndex()`](https://rformassspectrometry.github.io/Spectra/reference/fragmentGroupIndex.md)
  : Mass fragmentation collections of each full scan

- [`joinPeaks()`](https://rformassspectrometry.github.io/Spectra/reference/joinPeaks.md)
  [`joinPeaksGnps()`](https://rformassspectrometry.github.io/Spectra/reference/joinPeaks.md)
  [`joinPeaksNone()`](https://rformassspectrometry.github.io/Spectra/reference/joinPeaks.md)
  : Join (map) peaks of two spectra

- [`PrecursorMzParam()`](https://rformassspectrometry.github.io/Spectra/reference/neutralLoss.md)
  [`neutralLoss(`*`<Spectra>`*`,`*`<PrecursorMzParam>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/neutralLoss.md)
  : Calculate Neutral Loss Spectra

- [`computeMzDeltas()`](https://rformassspectrometry.github.io/Spectra/reference/plotMzDelta.md)
  [`plotMzDelta()`](https://rformassspectrometry.github.io/Spectra/reference/plotMzDelta.md)
  : MZ delta Quality Control

- [`precursorPurity()`](https://rformassspectrometry.github.io/Spectra/reference/precursorPurity.md)
  : Calculating Precursor Purity for MS2 spectra

- [`processingChunkSize(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/processingChunkSize.md)
  [`` `processingChunkSize<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/processingChunkSize.md)
  [`processingChunkFactor(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/processingChunkSize.md)
  [`backendBpparam(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/processingChunkSize.md)
  :

  Parallel and chunk-wise processing of `Spectra`

- [`plotSpectra()`](https://rformassspectrometry.github.io/Spectra/reference/spectra-plotting.md)
  [`plotSpectraOverlay()`](https://rformassspectrometry.github.io/Spectra/reference/spectra-plotting.md)
  [`plotSpectraMirror(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectra-plotting.md)
  : Plotting Spectra

- [`asDataFrame()`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`acquisitionNum(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`centroided(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `centroided<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`collisionEnergy(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `collisionEnergy<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`coreSpectraVariables()`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`dataOrigin(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `dataOrigin<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`dataStorage(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`intensity(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`ionCount(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`isCentroided(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`isEmpty(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`isolationWindowLowerMz(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `isolationWindowLowerMz<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`isolationWindowTargetMz(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `isolationWindowTargetMz<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`isolationWindowUpperMz(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `isolationWindowUpperMz<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`length(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`lengths(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`longForm(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`msLevel(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`mz(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`peaksData(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`peaksVariables(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`polarity(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `polarity<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`precScanNum(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`precursorCharge(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`precursorIntensity(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`precursorMz(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `precursorMz<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`rtime(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `rtime<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`scanIndex(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`smoothed(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `smoothed<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`spectraData(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `spectraData<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`spectraNames(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `spectraNames<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`spectraVariables(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`tic(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`uniqueMsLevels(`*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `$`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `$<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `[[`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  [`` `[[<-`( ``*`<Spectra>`*`)`](https://rformassspectrometry.github.io/Spectra/reference/spectraData.md)
  : Accessing mass spectrometry data

- [`spectraVariableMapping()`](https://rformassspectrometry.github.io/Spectra/reference/spectraVariableMapping.md)
  [`` `spectraVariableMapping<-`() ``](https://rformassspectrometry.github.io/Spectra/reference/spectraVariableMapping.md)
  : Mapping between spectra variables and data file fields

# Articles

### All vignettes

- [Creating new \`MsBackend\`
  classes](https://rformassspectrometry.github.io/Spectra/articles/MsBackend.md):
- [Large-scale data handling and processing with
  Spectra](https://rformassspectrometry.github.io/Spectra/articles/Spectra-large-scale.md):
- [Description and usage of Spectra
  objects](https://rformassspectrometry.github.io/Spectra/articles/Spectra.md):
