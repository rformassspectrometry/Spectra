<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Spectra() can be plotted with one of the following functions
plotSpectra: plots each spectrum in its separate plot by splitting
the plot area into as many panels as there are spectra.
plotSpectraOverlay: plots all spectra in x into the same plot (as
an overlay).
plotSpectraMirror: plots a pair of spectra as a mirror plot.
Parameters x and y both have to be a Spectra of length 1. Matching
peaks (considering ppm and tolerance) are highlighted. See common()
for details on peak matching. Parameters matchCol, matchLty,
matchLwd and matchPch allow to customize how matching peaks are
indicated.

"><title>Plotting Spectra — spectra-plotting • Spectra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting Spectra — spectra-plotting"><meta property="og:description" content="Spectra() can be plotted with one of the following functions
plotSpectra: plots each spectrum in its separate plot by splitting
the plot area into as many panels as there are spectra.
plotSpectraOverlay: plots all spectra in x into the same plot (as
an overlay).
plotSpectraMirror: plots a pair of spectra as a mirror plot.
Parameters x and y both have to be a Spectra of length 1. Matching
peaks (considering ppm and tolerance) are highlighted. See common()
for details on peak matching. Parameters matchCol, matchLty,
matchLwd and matchPch allow to customize how matching peaks are
indicated.

"><meta property="og:image" content="https://rformassspectrometry.github.io/Spectra/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Spectra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.13</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Spectra.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/Spectra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting Spectra</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/Spectra/blob/HEAD/R/plotting-functions.R" class="external-link"><code>R/plotting-functions.R</code></a></small>
      <div class="d-none name"><code>spectra-plotting.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code><a href="Spectra.html">Spectra()</a></code> can be plotted with one of the following functions</p><ul><li><p><code>plotSpectra</code>: plots each spectrum in its separate plot by splitting
the plot area into as many panels as there are spectra.</p></li>
<li><p><code>plotSpectraOverlay</code>: plots all spectra in <code>x</code> <strong>into the same</strong> plot (as
an overlay).</p></li>
<li><p><code>plotSpectraMirror</code>: plots a pair of spectra as a <em>mirror plot</em>.
Parameters <code>x</code> and <code>y</code> both have to be a <code>Spectra</code> of length 1. Matching
peaks (considering <code>ppm</code> and <code>tolerance</code>) are highlighted. See <code>common()</code>
for details on peak matching. Parameters <code>matchCol</code>, <code>matchLty</code>,
<code>matchLwd</code> and <code>matchPch</code> allow to customize how matching peaks are
indicated.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plotSpectra</span><span class="op">(</span>
  <span class="va">x</span>,
  xlab <span class="op">=</span> <span class="st">"m/z"</span>,
  ylab <span class="op">=</span> <span class="st">"intensity"</span>,
  type <span class="op">=</span> <span class="st">"h"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"#00000080"</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  labelCex <span class="op">=</span> <span class="fl">1</span>,
  labelSrt <span class="op">=</span> <span class="fl">0</span>,
  labelAdj <span class="op">=</span> <span class="cn">NULL</span>,
  labelPos <span class="op">=</span> <span class="cn">NULL</span>,
  labelOffset <span class="op">=</span> <span class="fl">0.5</span>,
  labelCol <span class="op">=</span> <span class="st">"#00000080"</span>,
  asp <span class="op">=</span> <span class="fl">1</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">plotSpectraOverlay</span><span class="op">(</span>
  <span class="va">x</span>,
  xlab <span class="op">=</span> <span class="st">"m/z"</span>,
  ylab <span class="op">=</span> <span class="st">"intensity"</span>,
  type <span class="op">=</span> <span class="st">"h"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"spectra"</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"#00000080"</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  labelCex <span class="op">=</span> <span class="fl">1</span>,
  labelSrt <span class="op">=</span> <span class="fl">0</span>,
  labelAdj <span class="op">=</span> <span class="cn">NULL</span>,
  labelPos <span class="op">=</span> <span class="cn">NULL</span>,
  labelOffset <span class="op">=</span> <span class="fl">0.5</span>,
  labelCol <span class="op">=</span> <span class="st">"#00000080"</span>,
  axes <span class="op">=</span> <span class="cn">TRUE</span>,
  frame.plot <span class="op">=</span> <span class="va">axes</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S4 method for Spectra</span>
<span class="fu">plotSpectraMirror</span><span class="op">(</span>
  <span class="va">x</span>,
  <span class="va">y</span>,
  xlab <span class="op">=</span> <span class="st">"m/z"</span>,
  ylab <span class="op">=</span> <span class="st">"intensity"</span>,
  type <span class="op">=</span> <span class="st">"h"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,
  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"#00000080"</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  labelCex <span class="op">=</span> <span class="fl">1</span>,
  labelSrt <span class="op">=</span> <span class="fl">0</span>,
  labelAdj <span class="op">=</span> <span class="cn">NULL</span>,
  labelPos <span class="op">=</span> <span class="cn">NULL</span>,
  labelOffset <span class="op">=</span> <span class="fl">0.5</span>,
  labelCol <span class="op">=</span> <span class="st">"#00000080"</span>,
  axes <span class="op">=</span> <span class="cn">TRUE</span>,
  frame.plot <span class="op">=</span> <span class="va">axes</span>,
  ppm <span class="op">=</span> <span class="fl">20</span>,
  tolerance <span class="op">=</span> <span class="fl">0</span>,
  matchCol <span class="op">=</span> <span class="st">"#80B1D3"</span>,
  matchLwd <span class="op">=</span> <span class="fl">1</span>,
  matchLty <span class="op">=</span> <span class="fl">1</span>,
  matchPch <span class="op">=</span> <span class="fl">16</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a <code><a href="Spectra.html">Spectra()</a></code> object. For <code>plotSpectraMirror</code> it has to be an
object of length 2.</p></dd>
<dt>xlab</dt>
<dd><p><code>character(1)</code> with the label for the x-axis (by default
<code>xlab = "m/z"</code>).</p></dd>
<dt>ylab</dt>
<dd><p><code>character(1)</code> with the label for the y-axis (by default
<code>ylab = "intensity"</code>).</p></dd>
<dt>type</dt>
<dd><p><code>character(1)</code> specifying the type of plot. See <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default()</a></code>
for details. Defaults to <code>type = "h"</code> which draws each peak as a line.</p></dd>
<dt>xlim</dt>
<dd><p><code>numeric(2)</code> defining the x-axis limits. The range of m/z values
are used by default.</p></dd>
<dt>ylim</dt>
<dd><p><code>numeric(2)</code> defining the y-axis limits. The range of intensity
values are used by default.</p></dd>
<dt>main</dt>
<dd><p><code>character(1)</code> with the title for the plot. By default the
spectrum's MS level and retention time (in seconds) is used.</p></dd>
<dt>col</dt>
<dd><p>color to be used to draw the peaks. Should be either of length 1,
or equal to the number of spectra (to plot each spectrum in a different
color) or be a <code>list</code> with colors for each individual peak in each
spectrum.</p></dd>
<dt>labels</dt>
<dd><p>allows to specify a label for each peak. Can be a <code>character</code>
with length equal to the number of peaks, or, ideally, a <code>function</code> that
uses one of the <code>Spectra</code>'s variables (see examples below).
<code>plotSpectraMirror</code> supports only <code>labels</code> of type <em>function</em>.</p></dd>
<dt>labelCex</dt>
<dd><p><code>numeric(1)</code> giving the amount by which the text should be
magnified relative to the default. See parameter <code>cex</code> in <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code>.</p></dd>
<dt>labelSrt</dt>
<dd><p><code>numeric(1)</code> defining the rotation of the label. See
parameter <code>srt</code> in <code><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text()</a></code>.</p></dd>
<dt>labelAdj</dt>
<dd><p>see parameter <code>adj</code> in <code><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text()</a></code>.</p></dd>
<dt>labelPos</dt>
<dd><p>see parameter <code>pos</code> in <code><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text()</a></code>.</p></dd>
<dt>labelOffset</dt>
<dd><p>see parameter <code>offset</code> in <code><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text()</a></code>.</p></dd>
<dt>labelCol</dt>
<dd><p>color for the label(s).</p></dd>
<dt>asp</dt>
<dd><p>for <code>plotSpectra</code>: the target ratio (columns / rows) when plotting
mutliple spectra (e.g. for 20 spectra use <code>asp = 4/5</code> for 4 columns and 5 rows
or <code>asp = 5/4</code> for 5 columns and 4 rows; see <code><a href="https://rdrr.io/r/grDevices/n2mfrow.html" class="external-link">grDevices::n2mfrow()</a></code> for
details).</p></dd>
<dt>...</dt>
<dd><p>additional parameters to be passed to the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default()</a></code>
function.</p></dd>
<dt>axes</dt>
<dd><p><code>logical(1)</code> whether (x and y) axes should be drawn.</p></dd>
<dt>frame.plot</dt>
<dd><p><code>logical(1)</code> whether a box should be drawn around the
plotting area.</p></dd>
<dt>y</dt>
<dd><p>for <code>plotSpectraMirror</code>: <code>Spectra</code> object of length 1 against which
<code>x</code> should be plotted against.</p></dd>
<dt>ppm</dt>
<dd><p>for <code>plotSpectraMirror</code>: m/z relative acceptable difference (in
ppm) for peaks to be considered matching (see <code>common()</code> for more
details).</p></dd>
<dt>tolerance</dt>
<dd><p>for <code>plotSpectraMirror</code>: absolute acceptable difference of
m/z values for peaks to be considered matching (see <code>common()</code> for more
details).</p></dd>
<dt>matchCol</dt>
<dd><p>for <code>plotSpectraMirror</code>: color for matching peaks.</p></dd>
<dt>matchLwd</dt>
<dd><p>for <code>plotSpectraMirror</code>: line width (<code>lwd</code>) to draw matching
peaks. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> for more details.</p></dd>
<dt>matchLty</dt>
<dd><p>for <code>plotSpectraMirror</code>: line type (<code>lty</code>) to draw matching
peaks. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> for more details.</p></dd>
<dt>matchPch</dt>
<dd><p>for <code>plotSpectraMirror</code>: point character (<code>pch</code>) to label
matching peaks. Defaults to <code>matchPch = 16</code>, set to <code>matchPch = NA</code> to
disable. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> for more details.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>These functions create a plot.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer, Sebastian Gibb, Laurent Gatto</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="va">ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.3412</span>, <span class="fl">12</span>, <span class="fl">8</span>, <span class="fl">34</span>, <span class="fl">23.4</span><span class="op">)</span>,</span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">25</span>, <span class="fl">16</span>, <span class="fl">32</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mzs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13.453421</span>, <span class="fl">43.433122</span>, <span class="fl">46.6653553</span>, <span class="fl">129.111212</span>, <span class="fl">322.24432</span><span class="op">)</span>,</span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13.452</span>, <span class="fl">43.5122</span>, <span class="fl">129.112</span>, <span class="fl">322.245</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>, rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123.12</span>, <span class="fl">124</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">df</span><span class="op">$</span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="va">mzs</span></span>
<span class="r-in"><span class="va">df</span><span class="op">$</span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="va">ints</span></span>
<span class="r-in"><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectra.html">Spectra</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### --------------------------------------------- ####</span></span>
<span class="r-in"><span class="co">##                   plotSpectra                     ##</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot one spectrum.</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot both spectra.</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Define a color for each peak in each spectrum.</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Color peaks from each spectrum in different colors.</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Label each peak with its m/z.</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span>, labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Rotate the labels.</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span>, labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span class="r-in">    labelPos <span class="op">=</span> <span class="fl">2</span>, labelOffset <span class="op">=</span> <span class="fl">0.1</span>, labelSrt <span class="op">=</span> <span class="op">-</span><span class="fl">30</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Add a custom annotation for each peak.</span></span>
<span class="r-in"><span class="va">sp</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Frodo"</span>, <span class="st">"Bilbo"</span>, <span class="st">"Peregrin"</span>, <span class="st">"Samwise"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Plot each peak in a different color</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span>, labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">label</span><span class="op">)</span>,</span>
<span class="r-in">    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot a single spectrum specifying the label.</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### --------------------------------------------- ####</span></span>
<span class="r-in"><span class="co">##                plotSpectraOverlay                 ##</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot both spectra overlaying.</span></span>
<span class="r-in"><span class="fu">plotSpectraOverlay</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Use a different color for each spectrum.</span></span>
<span class="r-in"><span class="fu">plotSpectraOverlay</span><span class="op">(</span><span class="va">sp</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000080"</span>, <span class="st">"#0000ff80"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Label also the peaks with their m/z if their intensity is above 15.</span></span>
<span class="r-in"><span class="fu">plotSpectraOverlay</span><span class="op">(</span><span class="va">sp</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ff000080"</span>, <span class="st">"#0000ff80"</span><span class="op">)</span>,</span>
<span class="r-in">    labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">        <span class="va">lbls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">lbls</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span class="r-in">        <span class="va">lbls</span></span>
<span class="r-in">    <span class="op">}</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">15</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-8.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Use different asp values</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span>, asp <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#### --------------------------------------------- ####</span></span>
<span class="r-in"><span class="co">##                plotSpectraMirror                  ##</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot two spectra against each other.</span></span>
<span class="r-in"><span class="fu">plotSpectraMirror</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Label the peaks with their m/z</span></span>
<span class="r-in"><span class="fu">plotSpectraMirror</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span class="r-in">    labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span class="r-in">    labelSrt <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>, labelPos <span class="op">=</span> <span class="fl">2</span>, labelOffset <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-10.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The same plot with a tolerance of 0.1 and using a different color to</span></span>
<span class="r-in"><span class="co">## highlight matching peaks</span></span>
<span class="r-in"><span class="fu">plotSpectraMirror</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span class="r-in">    labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span class="r-in">    labelSrt <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>, labelPos <span class="op">=</span> <span class="fl">2</span>, labelOffset <span class="op">=</span> <span class="fl">0.2</span>, tolerance <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span class="r-in">    matchCol <span class="op">=</span> <span class="st">"#ff000080"</span>, matchLwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="spectra-plotting-11.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto,
Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

