<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter peaks based on spectra and peaks variable ranges — filterPeaksRanges • Spectra</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter peaks based on spectra and peaks variable ranges — filterPeaksRanges"><meta name="description" content="The filterPeaksRanges() function allows to filter the peaks matrices of a
Spectra object using any set of range-based filters on numeric spectra
variables or peaks variables. These ranges can be passed to the function
using the ... as &amp;lt;variable name&amp;gt; = &amp;lt;range&amp;gt; pairs. &amp;lt;variable name&amp;gt;
has to be an available spectra or peaks variable. &amp;lt;range&amp;gt; can be a
numeric of length 2 defining the lower and upper boundary, or a numeric
two-column matrix (multi-row matrices are also supported, see further
below). filterPeaksRanges(s, mz = c(200, 300)) would for example reduce
the peaks matrices of the Spectra object s to mass peaks with an m/z
value between 200 and 300. filterPeaksRanges() returns the original
Spectra object with the filter operation added to the processing queue.
Thus, the filter gets only applied when the peaks data gets extracted
with mz(), intensity() or peaksData(). If ranges for both spectra
and peaks variables are defined, the function evaluates first whether
the spectra variable value for a spectrum is within the provided range and,
if so, applies also the peaks variable-based filter (otherwise an empty
peaks matrix is returned).
If more than one spectra variable and/or peaks variable are defined, their
filter results are combined with a logical AND: a peak matrix is only
returned for a spectrum if all values of spectra variables are within the
provided (respective) ranges for spectra variables, and this matrix is
further filtered to contain only those peaks which values are within the
provided peaks variable ranges.
Filtering with multiple ranges per spectra and peaks variables is also
supported: ranges can also be provided as multi-row numeric (two-column)
matrices. In this case, the above described procedure is applied for each
row separately and their results are combined with a logical OR, i.e.
peaks matrices are returned that match any of the conditions/filters
of a row. The number of rows of the provided ranges (being it for spectra
or peaks variables) have to match.
Missing value handling: any comparison which involves a missing value
(being it a spectra variable value, a peaks variable value or a value
in one of the provided ranges) is treated as a logical FALSE. For
example, if the retention time of a spectrum is NA and the data is
filtered using a retention time range, an empty peaks matrix is returned
(for keep = TRUE, for keep = FALSE the full peaks matrix is returned)."><meta property="og:description" content="The filterPeaksRanges() function allows to filter the peaks matrices of a
Spectra object using any set of range-based filters on numeric spectra
variables or peaks variables. These ranges can be passed to the function
using the ... as &amp;lt;variable name&amp;gt; = &amp;lt;range&amp;gt; pairs. &amp;lt;variable name&amp;gt;
has to be an available spectra or peaks variable. &amp;lt;range&amp;gt; can be a
numeric of length 2 defining the lower and upper boundary, or a numeric
two-column matrix (multi-row matrices are also supported, see further
below). filterPeaksRanges(s, mz = c(200, 300)) would for example reduce
the peaks matrices of the Spectra object s to mass peaks with an m/z
value between 200 and 300. filterPeaksRanges() returns the original
Spectra object with the filter operation added to the processing queue.
Thus, the filter gets only applied when the peaks data gets extracted
with mz(), intensity() or peaksData(). If ranges for both spectra
and peaks variables are defined, the function evaluates first whether
the spectra variable value for a spectrum is within the provided range and,
if so, applies also the peaks variable-based filter (otherwise an empty
peaks matrix is returned).
If more than one spectra variable and/or peaks variable are defined, their
filter results are combined with a logical AND: a peak matrix is only
returned for a spectrum if all values of spectra variables are within the
provided (respective) ranges for spectra variables, and this matrix is
further filtered to contain only those peaks which values are within the
provided peaks variable ranges.
Filtering with multiple ranges per spectra and peaks variables is also
supported: ranges can also be provided as multi-row numeric (two-column)
matrices. In this case, the above described procedure is applied for each
row separately and their results are combined with a logical OR, i.e.
peaks matrices are returned that match any of the conditions/filters
of a row. The number of rows of the provided ranges (being it for spectra
or peaks variables) have to match.
Missing value handling: any comparison which involves a missing value
(being it a spectra variable value, a peaks variable value or a value
in one of the provided ranges) is treated as a logical FALSE. For
example, if the retention time of a spectrum is NA and the data is
filtered using a retention time range, an empty peaks matrix is returned
(for keep = TRUE, for keep = FALSE the full peaks matrix is returned)."><meta property="og:image" content="https://rformassspectrometry.github.io/Spectra/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spectra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Spectra.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MsBackend.html">Creating new `MsBackend` classes</a></li>
    <li><a class="dropdown-item" href="../articles/Spectra-large-scale.html">Large-scale data handling and processing with Spectra</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/Spectra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Filter peaks based on spectra and peaks variable ranges</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/Spectra/blob/main/R/Spectra-functions.R" class="external-link"><code>R/Spectra-functions.R</code></a></small>
      <div class="d-none name"><code>filterPeaksRanges.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>filterPeaksRanges()</code> function allows to filter the peaks matrices of a
<a href="Spectra.html">Spectra</a> object using any set of range-based filters on numeric spectra
variables or peaks variables. These ranges can be passed to the function
using the <code>...</code> as <code>&lt;variable name&gt; = &lt;range&gt;</code> pairs. <code>&lt;variable name&gt;</code>
has to be an available spectra or peaks variable. <code>&lt;range&gt;</code> can be a
<code>numeric</code> of length 2 defining the lower and upper boundary, or a <code>numeric</code>
two-column matrix (multi-row matrices are also supported, see further
below). <code>filterPeaksRanges(s, mz = c(200, 300))</code> would for example reduce
the peaks matrices of the <code>Spectra</code> object <code>s</code> to mass peaks with an m/z
value between 200 and 300. <code>filterPeaksRanges()</code> returns the original
<code>Spectra</code> object with the filter operation added to the processing queue.
Thus, the filter gets <strong>only</strong> applied when the peaks data gets extracted
with <code><a href="spectraData.html">mz()</a></code>, <code><a href="spectraData.html">intensity()</a></code> or <code><a href="spectraData.html">peaksData()</a></code>. If ranges for both spectra
<strong>and</strong> peaks variables are defined, the function evaluates first whether
the spectra variable value for a spectrum is within the provided range and,
if so, applies also the peaks variable-based filter (otherwise an empty
peaks matrix is returned).</p>
<p>If more than one spectra variable and/or peaks variable are defined, their
filter results are combined with a logical AND: a peak matrix is only
returned for a spectrum if all values of spectra variables are within the
provided (respective) ranges for spectra variables, and this matrix is
further filtered to contain only those peaks which values are within the
provided peaks variable ranges.</p>
<p><strong>Filtering with multiple ranges</strong> per spectra and peaks variables is also
supported: ranges can also be provided as multi-row numeric (two-column)
matrices. In this case, the above described procedure is applied for each
row separately and their results are combined with a logical OR, i.e.
peaks matrices are returned that match any of the conditions/filters
of a row. The number of rows of the provided ranges (being it for spectra
or peaks variables) have to match.</p>
<p><strong>Missing value handling</strong>: any comparison which involves a missing value
(being it a spectra variable value, a peaks variable value or a value
in one of the provided ranges) is treated as a logical <code>FALSE</code>. For
example, if the retention time of a spectrum is <code>NA</code> and the data is
filtered using a retention time range, an empty peaks matrix is returned
(for <code>keep = TRUE</code>, for <code>keep = FALSE</code> the full peaks matrix is returned).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filterPeaksRanges</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, keep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <a href="Spectra.html">Spectra</a> object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>the ranges for the spectra and/or peaks variables. Has to be
provided as <code>&lt;name&gt; = &lt;range&gt;</code> pairs with <code>&lt;name&gt;</code> being the name of a
spectra or peaks variable (of numeric data type) and <code>&lt;range&gt;</code> being
either a <code>numeric</code> of length 2 or a <code>numeric</code> two column matrix (see
function desription above for details),</p></dd>


<dt id="arg-keep">keep<a class="anchor" aria-label="anchor" href="#arg-keep"></a></dt>
<dd><p><code>logical(1)</code> whether to keep (default) or remove peaks that
match the provided range(s).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In contrast to some other <em>filter</em> functions, this function does not provide
a <code>msLevel</code> parameter that allows to define the MS level of spectra on which
the filter should be applied. The filter(s) will always be applied to
<strong>all</strong> spectra (irrespectively of their MS level). Through combination of
multiple filter ranges it is however possible to apply MS level-dependent
filters (see examples below for details).</p>
<p>The filter will not be applied immediately to the data but only executed when
the mass peak data is accessed (through <code><a href="spectraData.html">peaksData()</a></code>, <code><a href="spectraData.html">mz()</a></code> or
<code><a href="spectraData.html">intensity()</a></code>) or by calling <code><a href="addProcessing.html">applyProcessing()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define a test Spectra</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123.2</span>, <span class="fl">134.2</span><span class="op">)</span>, msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100.1</span>, <span class="fl">100.2</span>, <span class="fl">100.3</span>, <span class="fl">200.1</span>, <span class="fl">200.2</span>, <span class="fl">300.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100.3</span>, <span class="fl">100.4</span>, <span class="fl">200.2</span>, <span class="fl">400.3</span>, <span class="fl">400.4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Use the index of the mass peak within the spectrum as index for</span></span></span>
<span class="r-in"><span><span class="co">## better illustration of filtering results</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectra.html">Spectra</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 2 spectra in a MsBackendMemory backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1     123.2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2     134.2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 16 more variables/columns.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Filter peaks removing all mass peaks with an m/z between 200 and 300</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">filterPeaksRanges</span><span class="op">(</span><span class="va">s</span>, mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span>, keep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 2 spectra in a MsBackendMemory backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1     123.2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2     134.2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 16 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lazy evaluation queue: 1 processing step(s)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Filter: remove peaks based on user-provided ranges for 1 variables [Mon Dec  9 10:21:49 2024] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The Spectra object has still the same length and spectra variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">rtime</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 123.2 134.2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The filter gets applied when mass peak data gets extracted, using either</span></span></span>
<span class="r-in"><span><span class="co">## `mz()`, `intensity()` or `peaksData()`. The filtered peaks data does</span></span></span>
<span class="r-in"><span><span class="co">## not contain any mass peaks with m/z values between 200 and 300:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.1         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 100.2         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 100.3         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 300.3         6</span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 100.4         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 400.3         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 400.4         5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We next combine spectra and filter variables. We want to keep only mass</span></span></span>
<span class="r-in"><span><span class="co">## peaks of MS2 spectra that have an m/z between 100 and 110.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">filterPeaksRanges</span><span class="op">(</span><span class="va">s</span>, mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">110</span><span class="op">)</span>, msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 2 spectra in a MsBackendMemory backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1     123.2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2     134.2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 16 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lazy evaluation queue: 1 processing step(s)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Filter: select peaks based on user-provided ranges for 2 variables [Mon Dec  9 10:21:49 2024] </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Only data for peaks are returned for which the spectra's MS level is</span></span></span>
<span class="r-in"><span><span class="co">## between 2 and 2 and with an m/z between 100 and 110. The peaks data for</span></span></span>
<span class="r-in"><span><span class="co">## the first spectrum, that has MS level 1, is thus empty:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mz intensity</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## While the peaks matrix for the second spectrum (with MS level 2) contains</span></span></span>
<span class="r-in"><span><span class="co">## the mass peaks with m/z between 100 and 110.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 100.4         2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To keep also the peaks data for the first spectrum, we need to define</span></span></span>
<span class="r-in"><span><span class="co">## an additional set of ranges, which we define using a second row in each</span></span></span>
<span class="r-in"><span><span class="co">## ranges matrix. We use the same filter as above, i.e. keeping only mass</span></span></span>
<span class="r-in"><span><span class="co">## peaks with an m/z between 100 and 110 for spectra with MS level 2, but</span></span></span>
<span class="r-in"><span><span class="co">## add an additional row for MS level 1 spectra keeping mass peaks with an</span></span></span>
<span class="r-in"><span><span class="co">## m/z between 0 and 2000. Filter results of different rows are combined</span></span></span>
<span class="r-in"><span><span class="co">## using a logical OR, i.e. peaks matrices with mass peaks are returned</span></span></span>
<span class="r-in"><span><span class="co">## matching either the first, or the second row.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">filterPeaksRanges</span><span class="op">(</span><span class="va">s</span>, mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">110</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The results for the MS level 2 spectrum are the same as before, but with</span></span></span>
<span class="r-in"><span><span class="co">## the additional row we keep the full peaks matrix of the MS1 spectrum:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.1         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 100.2         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 100.3         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 200.1         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 200.2         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 300.3         6</span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 100.4         2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## As a last example we define a filter that keeps all mass peaks with an</span></span></span>
<span class="r-in"><span><span class="co">## m/z either between 100 and 200, or between 300 and 400.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">filterPeaksRanges</span><span class="op">(</span><span class="va">s</span>, mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">400</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.1         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 100.2         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 100.3         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 300.3         6</span>
<span class="r-in"><span><span class="fu"><a href="spectraData.html">peaksData</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">2L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 100.4         2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Such filters could thus be defined to restrict/filter the MS data to</span></span></span>
<span class="r-in"><span><span class="co">## specific e.g. retention time and m/z ranges.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto, Johannes Rainer, Sebastian Gibb, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

