<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This help page lists functions that convert MS/MS spectra to neutral loss
spectra. The main function for this is neutralLoss and the specific
algorithm to be used is defined (and configured) with dedicated parameter
objects (paramer param of the neutralLoss function).
The parameter objects for the different algorithms are:
PrecursorMzParam: calculates neutral loss spectra as in Aisporna
et al. 2022 by subtracting the (fragment's) peak m/z value from the
precursor m/z value of each spectrum (precursor m/z - fragment m/z).
Parameter msLevel allows to restrict calculation of neutral loss
spectra to specified MS level(s). Spectra from other MS level(s) are
returned as-is. Parameter filterPeaks allows to remove certain peaks
from the neutral loss spectra. By default (filterPeaks = &quot;none&quot;) no
filtering takes place. With filterPeaks = &quot;removePrecursor&quot; all fragment
peaks with an m/z value matching the precursor m/z (considering also ppm
and tolerance are removed. With filterPeaks = &quot;abovePrecursor&quot;, all
fragment peaks with an m/z larger than the precursor m/z (m/z &amp;gt; precursor
m/z - tolerance - ppm of the precursor m/z) are removed (thus removing
also in most cases the fragment peaks representing the precursor). Finally,
with filterPeaks = &quot;belowPrecursor&quot; all fragment peaks with an m/z
smaller than the precursor m/z (m/z &amp;lt; precursor m/z + tolerance + ppm
of the precursor m/z) are removed. Also in this case the precursor
fragment peak is (depending on the values of ppm and tolerance)
removed.

"><title>Calculate Neutral Loss Spectra — neutralLoss • Spectra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Neutral Loss Spectra — neutralLoss"><meta property="og:description" content="This help page lists functions that convert MS/MS spectra to neutral loss
spectra. The main function for this is neutralLoss and the specific
algorithm to be used is defined (and configured) with dedicated parameter
objects (paramer param of the neutralLoss function).
The parameter objects for the different algorithms are:
PrecursorMzParam: calculates neutral loss spectra as in Aisporna
et al. 2022 by subtracting the (fragment's) peak m/z value from the
precursor m/z value of each spectrum (precursor m/z - fragment m/z).
Parameter msLevel allows to restrict calculation of neutral loss
spectra to specified MS level(s). Spectra from other MS level(s) are
returned as-is. Parameter filterPeaks allows to remove certain peaks
from the neutral loss spectra. By default (filterPeaks = &quot;none&quot;) no
filtering takes place. With filterPeaks = &quot;removePrecursor&quot; all fragment
peaks with an m/z value matching the precursor m/z (considering also ppm
and tolerance are removed. With filterPeaks = &quot;abovePrecursor&quot;, all
fragment peaks with an m/z larger than the precursor m/z (m/z &amp;gt; precursor
m/z - tolerance - ppm of the precursor m/z) are removed (thus removing
also in most cases the fragment peaks representing the precursor). Finally,
with filterPeaks = &quot;belowPrecursor&quot; all fragment peaks with an m/z
smaller than the precursor m/z (m/z &amp;lt; precursor m/z + tolerance + ppm
of the precursor m/z) are removed. Also in this case the precursor
fragment peak is (depending on the values of ppm and tolerance)
removed.

"><meta property="og:image" content="https://rformassspectrometry.github.io/Spectra/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Spectra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.20</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Spectra.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/Spectra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Neutral Loss Spectra</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/Spectra/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/RforMassSpectrometry/Spectra/blob/HEAD/R/Spectra-neutralLoss.R" class="external-link"><code>R/Spectra-neutralLoss.R</code></a></small>
      <div class="d-none name"><code>neutralLoss.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This help page lists functions that convert MS/MS spectra to neutral loss
spectra. The main function for this is <code>neutralLoss</code> and the specific
algorithm to be used is defined (and configured) with dedicated <em>parameter</em>
objects (paramer <code>param</code> of the <code>neutralLoss</code> function).</p>
<p>The parameter objects for the different algorithms are:</p><ul><li><p><code>PrecursorMzParam</code>: calculates neutral loss spectra as in Aisporna
<em>et al.</em> 2022 by subtracting the (fragment's) peak m/z value from the
precursor m/z value of each spectrum (precursor m/z - fragment m/z).
Parameter <code>msLevel</code> allows to restrict calculation of neutral loss
spectra to specified MS level(s). Spectra from other MS level(s) are
returned as-is. Parameter <code>filterPeaks</code> allows to remove certain peaks
from the neutral loss spectra. By default (<code>filterPeaks = "none"</code>) no
filtering takes place. With <code>filterPeaks = "removePrecursor"</code> all fragment
peaks with an m/z value matching the precursor m/z (considering also <code>ppm</code>
and <code>tolerance</code> are removed. With <code>filterPeaks = "abovePrecursor"</code>, all
fragment peaks with an m/z larger than the precursor m/z (m/z &gt; precursor
m/z - <code>tolerance</code> - <code>ppm</code> of the precursor m/z) are removed (thus removing
also in most cases the fragment peaks representing the precursor). Finally,
with <code>filterPeaks = "belowPrecursor"</code> all fragment peaks with an m/z
smaller than the precursor m/z (m/z &lt; precursor m/z + <code>tolerance</code> + <code>ppm</code>
of the precursor m/z) are removed. Also in this case the precursor
fragment peak is (depending on the values of <code>ppm</code> and <code>tolerance</code>)
removed.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">neutralLoss</span><span class="op">(</span><span class="va">object</span>, <span class="va">param</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">PrecursorMzParam</span><span class="op">(</span>
  filterPeaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"abovePrecursor"</span>, <span class="st">"belowPrecursor"</span>, <span class="st">"removePrecursor"</span><span class="op">)</span>,
  msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="cn">NA_integer_</span><span class="op">)</span>,
  ppm <span class="op">=</span> <span class="fl">10</span>,
  tolerance <span class="op">=</span> <span class="fl">0</span>
<span class="op">)</span>

<span class="co"># S4 method for Spectra,PrecursorMzParam</span>
<span class="fu">neutralLoss</span><span class="op">(</span><span class="va">object</span>, <span class="va">param</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code><a href="Spectra.html">Spectra()</a></code> object with the fragment spectra for which neutral
loss spectra should be calculated.</p></dd>
<dt>param</dt>
<dd><p>One of the <em>parameter</em> objects discussed below.</p></dd>
<dt>...</dt>
<dd><p>Currently ignored.</p></dd>
<dt>filterPeaks</dt>
<dd><p>For <code>PrecursorMzParam</code>: <code>character(1)</code> or <code>function</code>
defining if and how fragment peaks should be filtered before calculation.
Pre-defined options are: <code>"none"</code> (keep all peaks), <code>"abovePrecursor"</code>
(removes all fragment peaks with an m/z &gt;= precursor m/z),
<code>"belowPrecursor"</code> (removes all fragment peaks with an m/z &lt;= precursor
m/z). In addition, it is possible to pass a custom function with this
parameter with arguments <code>x</code> (two column peak matrix) and <code>precursorMz</code>
(the precursor m/z) that returns the sub-setted two column peak matrix.</p></dd>
<dt>msLevel</dt>
<dd><p><code>integer</code> defining for which MS level(s) the neutral loss
spectra should be calculated. Defaults to <code>msLevel = c(2L, NA)</code> thus,
neutral loss spectra will be calculated for all spectra with MS level
equal to 2 or with missing/undefined MS level. All spectra with a MS
level different than <code>msLevel</code> will be returned unchanged.</p></dd>
<dt>ppm</dt>
<dd><p><code>numeric(1)</code> with m/z-relative acceptable difference in m/z
values to filter peaks. Defaults to <code>ppm = 10</code>. See function description
for details.</p></dd>
<dt>tolerance</dt>
<dd><p><code>numeric(1)</code> with absolute acceptable difference in m/z
values to filter peaks. Defaults to <code>tolerance = 0</code>. See function
description for details.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="Spectra.html">Spectra()</a></code> object with calculated neutral loss spectra.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>By definition, mass peaks in a <code>Spectra</code> object need to be ordered by their
m/z value (in increasing order). Thus, the order of the peaks in the
calculated neutral loss spectra might not be the same than in the original
<code>Spectra</code> object.</p>
<p>Note also that for spectra with a missing precursor m/z empty spectra are
returned (i.e. spectra without peaks) since it is not possible to calcualte
the neutral loss spectra.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Aisporna A, Benton PH, Chen A, Derks RJE, Galano JM, Giera M and Siuzdak G
(2022). Neutral Loss Mass Spectral Data Enhances Molecular Similarity
Analysis in METLIN. Journal of the American Society for Mass Spectrometry.
doi: <a href="https://doi.org/10.1021/jasms.1c00343" class="external-link">10.1021/jasms.1c00343</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Create a simple example Spectra object with some MS1, MS2 and MS3 spectra.</span></span>
<span class="r-in"><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>,</span>
<span class="r-in">                precursorMz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">40</span>, <span class="fl">20</span>, <span class="cn">NA</span>, <span class="fl">300</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">DF</span><span class="op">$</span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="fu">IRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/AtomicList-class.html" class="external-link">NumericList</a></span><span class="op">(</span></span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">23</span>, <span class="fl">39</span>, <span class="fl">86</span><span class="op">)</span>,</span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">20</span>, <span class="fl">34</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">20</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">53</span>, <span class="fl">299</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">34</span>, <span class="fl">56</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">204</span>, <span class="fl">309</span><span class="op">)</span></span>
<span class="r-in">                  , compress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">DF</span><span class="op">$</span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu">IRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/AtomicList-class.html" class="external-link">NumericList</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span class="r-in">                                     compress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectra.html">Spectra</a></span><span class="op">(</span><span class="va">DF</span>, backend <span class="op">=</span> <span class="fu"><a href="MsBackend.html">MsBackendDataFrame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Calculate neutral loss spectra for all MS2 spectra, keeping MS1 and MS3</span></span>
<span class="r-in"><span class="co">## spectra unchanged.</span></span>
<span class="r-in"><span class="va">sps_nl</span> <span class="op">&lt;-</span> <span class="fu">neutralLoss</span><span class="op">(</span><span class="va">sps</span>, <span class="fu">PrecursorMzParam</span><span class="op">(</span>msLevel <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sps</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 3 12 14 15 16 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] 13 23 39 86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]] 5 7 20 34 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]] 5 7 9 20 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]] 15 53 299 300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]] 34 56 100 200 204 309</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sps_nl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 3 12 14 15 16 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] -46 1 17 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]] 5 7 20 34 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]] 5 7 9 20 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]] 0 1 247 285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]] 34 56 100 200 204 309</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Calculate neutral loss spectra for MS2 and MS3 spectra, removing peaks</span></span>
<span class="r-in"><span class="co">## with an m/z &gt;= precursorMz</span></span>
<span class="r-in"><span class="va">sps_nl</span> <span class="op">&lt;-</span> <span class="fu">neutralLoss</span><span class="op">(</span><span class="va">sps</span>, <span class="fu">PrecursorMzParam</span><span class="op">(</span></span>
<span class="r-in">    filterPeaks <span class="op">=</span> <span class="st">"abovePrecursor"</span>, msLevel <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sps_nl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 3 12 14 15 16 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] 1 17 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]] 13 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]] 5 7 9 20 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]] 1 247 285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]] 100 144 166</span>
<span class="r-in"><span class="co">## This removed also the peak with m/z 39 from the second spectrum</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Removing all fragment peaks matching the precursor m/z with a tolerance</span></span>
<span class="r-in"><span class="co">## of 1 and ppm 10</span></span>
<span class="r-in"><span class="va">sps_nl</span> <span class="op">&lt;-</span> <span class="fu">neutralLoss</span><span class="op">(</span><span class="va">sps</span>, <span class="fu">PrecursorMzParam</span><span class="op">(</span></span>
<span class="r-in">    filterPeaks <span class="op">=</span> <span class="st">"removePrecursor"</span>, tolerance <span class="op">=</span> <span class="fl">1</span>, ppm <span class="op">=</span> <span class="fl">10</span>, msLevel <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sps_nl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 3 12 14 15 16 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] -46 17 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]] -30 -14 13 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]] 5 7 9 20 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]] 247 285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]] -109 -4 100 144 166</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Empty spectra are returned for MS 2 spectra with undefined precursor m/z.</span></span>
<span class="r-in"><span class="va">sps</span><span class="op">$</span><span class="va">precursorMz</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span>
<span class="r-in"><span class="va">sps_nl</span> <span class="op">&lt;-</span> <span class="fu">neutralLoss</span><span class="op">(</span><span class="va">sps</span>, <span class="fu">PrecursorMzParam</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sps_nl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 3 12 14 15 16 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]] 5 7 20 34 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]] 5 7 9 20 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]] numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]] 34 56 100 200 204 309</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto,
Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

