<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Accessing mass spectrometry data — spectraData • Spectra</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Accessing mass spectrometry data — spectraData"><meta name="description" content="As detailed in the documentation of the Spectra class, a Spectra object
is a container for mass spectrometry (MS) data that includes both the mass
peaks data (or peaks data, generally m/z and intensity values) as well
as spectra metadata (so called spectra variables). Spectra variables
generally define one value per spectrum, while for peaks variables one value
per mass peak is defined and hence multiple values per spectrum (depending
on the number of mass peaks of a spectrum).
Data can be extracted from a Spectra object using dedicated accessor
functions or also using the $ operator. Depending on the backend class
used by the Spectra to represent the data, data can also be added or
replaced (again, using dedicated functions or using $&amp;lt;-)."><meta property="og:description" content="As detailed in the documentation of the Spectra class, a Spectra object
is a container for mass spectrometry (MS) data that includes both the mass
peaks data (or peaks data, generally m/z and intensity values) as well
as spectra metadata (so called spectra variables). Spectra variables
generally define one value per spectrum, while for peaks variables one value
per mass peak is defined and hence multiple values per spectrum (depending
on the number of mass peaks of a spectrum).
Data can be extracted from a Spectra object using dedicated accessor
functions or also using the $ operator. Depending on the backend class
used by the Spectra to represent the data, data can also be added or
replaced (again, using dedicated functions or using $&amp;lt;-)."><meta property="og:image" content="https://rformassspectrometry.github.io/Spectra/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spectra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Spectra.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MsBackend.html">Creating new `MsBackend` classes</a></li>
    <li><a class="dropdown-item" href="../articles/Spectra-large-scale.html">Large-scale data handling and processing with Spectra</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/Spectra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Accessing mass spectrometry data</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/Spectra/blob/main/R/Spectra.R" class="external-link"><code>R/Spectra.R</code></a></small>
      <div class="d-none name"><code>spectraData.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>As detailed in the documentation of the <a href="Spectra.html">Spectra</a> class, a <code>Spectra</code> object
is a container for mass spectrometry (MS) data that includes both the mass
peaks data (or <em>peaks data</em>, generally <em>m/z</em> and intensity values) as well
as spectra metadata (so called <em>spectra variables</em>). Spectra variables
generally define one value per spectrum, while for peaks variables one value
per mass peak is defined and hence multiple values per spectrum (depending
on the number of mass peaks of a spectrum).</p>
<p>Data can be extracted from a <code>Spectra</code> object using dedicated accessor
functions or also using the <code>$</code> operator. Depending on the backend class
used by the <code>Spectra</code> to represent the data, data can also be added or
replaced (again, using dedicated functions or using <code>$&lt;-</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">asDataFrame</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  spectraVars <span class="op">=</span> <span class="fu">spectraVariables</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">acquisitionNum</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">centroided</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">centroided</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">collisionEnergy</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">collisionEnergy</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="fu">coreSpectraVariables</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">dataOrigin</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">dataOrigin</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">dataStorage</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">intensity</span><span class="op">(</span><span class="va">object</span>, f <span class="op">=</span> <span class="fu"><a href="processingChunkSize.html">processingChunkFactor</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">ionCount</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isCentroided</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isEmpty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isolationWindowLowerMz</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isolationWindowLowerMz</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isolationWindowTargetMz</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isolationWindowTargetMz</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isolationWindowUpperMz</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">isolationWindowUpperMz</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">lengths</span><span class="op">(</span><span class="va">x</span>, use.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">msLevel</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">mz</span><span class="op">(</span><span class="va">object</span>, f <span class="op">=</span> <span class="fu"><a href="processingChunkSize.html">processingChunkFactor</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">peaksData</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"intensity"</span><span class="op">)</span>,</span>
<span>  f <span class="op">=</span> <span class="fu"><a href="processingChunkSize.html">processingChunkFactor</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">peaksVariables</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">polarity</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">polarity</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">precScanNum</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">precursorCharge</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">precursorIntensity</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">precursorMz</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">precursorMz</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">rtime</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">rtime</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">scanIndex</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">smoothed</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">smoothed</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">spectraData</span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="fu">spectraVariables</span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">spectraData</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">spectraNames</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">spectraNames</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">spectraVariables</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">tic</span><span class="op">(</span><span class="va">object</span>, initial <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="fu">uniqueMsLevels</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">name</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="va">x</span><span class="op">[[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra'</span></span>
<span><span class="va">x</span><span class="op">[[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">value</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>Spectra</code> object.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>For <code>asDataFrame()</code>: A <code>numeric</code> indicating which scans to coerce
to a <code>DataFrame</code> (default is <code>seq_along(object)</code>).</p></dd>


<dt id="arg-spectravars">spectraVars<a class="anchor" aria-label="anchor" href="#arg-spectravars"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> indicating what spectra variables to add to
the <code>DataFrame</code>. Default is <code>spectraVariables(object)</code>, i.e. all
available variables.</p></dd>


<dt id="arg-value">value<a class="anchor" aria-label="anchor" href="#arg-value"></a></dt>
<dd><p>A vector with values to replace the respective spectra
variable. Needs to be of the correct data type for the spectra variable.</p></dd>


<dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>For <code>intensity()</code>, <code>mz()</code> and <code>peaksData()</code>: factor defining how
data should be chunk-wise loaded an processed. Defaults to
<code><a href="processingChunkSize.html">processingChunkFactor()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>Spectra</code> object.</p></dd>


<dt id="arg-use-names">use.names<a class="anchor" aria-label="anchor" href="#arg-use-names"></a></dt>
<dd><p>For <code>lengths()</code>: ignored.</p></dd>


<dt id="arg-columns">columns<a class="anchor" aria-label="anchor" href="#arg-columns"></a></dt>
<dd><p>For <code>spectraData()</code> accessor: optional <code>character</code> with
column names (spectra variables) that should be included in the
returned <code>DataFrame</code>. By default, all columns are returned.
For <code>peaksData()</code> accessor: optional <code>character</code> with requested columns
in the individual <code>matrix</code> of the returned <code>list</code>. Defaults to
<code>c("mz", "value")</code> but any values returned by <code>peaksVariables(object)</code>
with <code>object</code> being the <code>Spectra</code> object are supported.</p></dd>


<dt id="arg-bpparam">BPPARAM<a class="anchor" aria-label="anchor" href="#arg-bpparam"></a></dt>
<dd><p>Parallel setup configuration. See <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">BiocParallel::bpparam()</a></code>
for more information. See also <code><a href="processingChunkSize.html">processingChunkSize()</a></code> for more
information on parallel processing.</p></dd>


<dt id="arg-initial">initial<a class="anchor" aria-label="anchor" href="#arg-initial"></a></dt>
<dd><p>For <code>tic()</code>: <code>logical(1)</code> whether the initially
reported total ion current should be reported, or whether the
total ion current should be (re)calculated on the actual data
(<code>initial = FALSE</code>, same as <code>ionCount()</code>).</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>For <code>$</code> and <code>$&lt;-</code>: the name of the spectra variable to return
or set.</p></dd>


<dt id="arg-j">j<a class="anchor" aria-label="anchor" href="#arg-j"></a></dt>
<dd><p>For <code>[</code>: not supported.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="spectra-variables">Spectra variables<a class="anchor" aria-label="anchor" href="#spectra-variables"></a></h2>



<p>A common set of <em>core spectra variables</em> are defined for <code>Spectra</code>. These
have a pre-defined data type and each <code>Spectra</code> will return a value for
these if requested. If no value for a spectra variable is defined, a missing
value (of the correct data type) is returned. The list of core spectra
variables and their respective data type is:</p><ul><li><p><em>acquisitionNum</em> <code>integer(1)</code>: the index of acquisition of a spectrum
during an MS run.</p></li>
<li><p><em>centroided</em> <code>logical(1)</code>: whether the spectrum is in profile or centroid
mode.</p></li>
<li><p><em>collisionEnergy</em> <code>numeric(1)</code>: collision energy used to create an MSn
spectrum.</p></li>
<li><p><em>dataOrigin</em> <code>character(1)</code>: the <em>origin</em> of the spectrum's data, e.g. the
mzML file from which it was read.</p></li>
<li><p><em>dataStorage</em> <code>character(1)</code>: the (current) storage location of the
spectrum data. This value depends on the backend used to handle and
provide the data. For an <em>in-memory</em> backend like the <code>MsBackendDataFrame</code>
this will be <code>"&lt;memory&gt;"</code>, for an on-disk backend such as the
<code>MsBackendHdf5Peaks</code> it will be the name of the HDF5 file where the
spectrum's peak data is stored.</p></li>
<li><p><em>isolationWindowLowerMz</em> <code>numeric(1)</code>: lower m/z for the isolation
window in which the (MSn) spectrum was measured.</p></li>
<li><p><em>isolationWindowTargetMz</em> <code>numeric(1)</code>: the target m/z for the isolation
window in which the (MSn) spectrum was measured.</p></li>
<li><p><em>isolationWindowUpperMz</em> <code>numeric(1)</code>: upper m/z for the isolation window
in which the (MSn) spectrum was measured.</p></li>
<li><p><em>msLevel</em> <code>integer(1)</code>: the MS level of the spectrum.</p></li>
<li><p><em>polarity</em> <code>integer(1)</code>: the polarity of the spectrum (<code>0</code> and <code>1</code>
representing negative and positive polarity, respectively).</p></li>
<li><p><em>precScanNum</em> <code>integer(1)</code>: the scan (acquisition) number of the precursor
for an MSn spectrum.</p></li>
<li><p><em>precursorCharge</em> <code>integer(1)</code>: the charge of the precursor of an MSn
spectrum.</p></li>
<li><p><em>precursorIntensity</em> <code>numeric(1)</code>: the intensity of the precursor of an
MSn spectrum.</p></li>
<li><p><em>precursorMz</em> <code>numeric(1)</code>: the m/z of the precursor of an MSn spectrum.</p></li>
<li><p><em>rtime</em> <code>numeric(1)</code>: the retention time of a spectrum.</p></li>
<li><p><em>scanIndex</em> <code>integer(1)</code>: the index of a spectrum within a (raw) file.</p></li>
<li><p><em>smoothed</em> <code>logical(1)</code>: whether the spectrum was smoothed.</p></li>
</ul><p>For each of these spectra variable a dedicated accessor function is defined
(such as <code>msLevel()</code> or <code>rtime()</code>) that allows to extract the values of
that spectra variable for all spectra in a <code>Spectra</code> object. Also,
replacement functions are defined, but not all backends might support
replacing values for spectra variables. As described above, additional
spectra variables can be defined or added. The <code>spectraVariables()</code> function
can be used to</p>
<p>Values for multiple spectra variables, or all spectra vartiables* can be
extracted with the <code>spectraData()</code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="peaks-variables">Peaks variables<a class="anchor" aria-label="anchor" href="#peaks-variables"></a></h2>



<p><code>Spectra</code> also provide mass peak data with the <em>m/z</em> and intensity values
being the <em>core</em> peaks variables:</p><ul><li><p><em>intensity</em> <code>numeric</code>: intensity values for the spectrum's peaks.</p></li>
<li><p><em>mz</em> <code>numeric</code>: the m/z values for the spectrum's peaks.</p></li>
</ul><p>Values for these can be extracted with the <code>mz()</code> and <code>intensity()</code>
functions, or the <code>peaksData()</code> function. The former functions return a
<code>NumericList</code> with the respective values, while the latter returns a <code>List</code>
with <code>numeric</code> two-column matrices. The list of peaks matrices can also
be extracted using <code>as(x, "list")</code> or <code>as(x, "SimpleList")</code> with <code>x</code> being
a <code>Spectra</code> object.</p>
<p>Some <code>Spectra</code>/backends provide also values for additional peaks variables.
The set of available peaks variables can be extracted with the
<code>peaksVariables()</code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="functions-to-access-ms-data">Functions to access MS data<a class="anchor" aria-label="anchor" href="#functions-to-access-ms-data"></a></h2>



<p>The set of available functions to extract data from, or set data in, a
<code>Spectra</code> object are (in alphabetical order) listed below. Note that there
are also other functions to extract information from a <code>Spectra</code> object
documented in <code><a href="addProcessing.html">addProcessing()</a></code>.</p><ul><li><p><code>$</code>, <code>$&lt;-</code>: gets (or sets) a spectra variable for all spectra in <code>object</code>.
See examples for details. Note that replacing values of a peaks variable
is not supported with a non-empty processing queue, i.e. if any filtering
or data manipulations on the peaks data was performed. In these cases
<code><a href="addProcessing.html">applyProcessing()</a></code> needs to be called first to apply all cached data
operations.</p></li>
<li><p><code>[[</code>, <code>[[&lt;-</code>: access or set/add a single spectrum variable (column) in the
backend.</p></li>
<li><p><code>acquisitionNum()</code>: returns the acquisition number of each
spectrum. Returns an <code>integer</code> of length equal to the number of
spectra (with <code>NA_integer_</code> if not available).</p></li>
<li><p><code>asDataFrame()</code>: converts the <code>Spectra</code> to a <code>DataFrame</code> (in long format)
contining all data. Returns a <code>DataFrame</code>.</p></li>
<li><p><code>centroided()</code>, <code>centroided&lt;-</code>: gets or sets the centroiding
information of the spectra. <code>centroided()</code> returns a <code>logical</code>
vector of length equal to the number of spectra with <code>TRUE</code> if a
spectrum is centroided, <code>FALSE</code> if it is in profile mode and <code>NA</code>
if it is undefined. See also <code>isCentroided()</code> for estimating from
the spectrum data whether the spectrum is centroided. <code>value</code>
for <code>centroided&lt;-</code> is either a single <code>logical</code> or a <code>logical</code> of
length equal to the number of spectra in <code>object</code>.</p></li>
<li><p><code>collisionEnergy()</code>, <code>collisionEnergy&lt;-</code>: gets or sets the
collision energy for all spectra in <code>object</code>. <code>collisionEnergy()</code>
returns a <code>numeric</code> with length equal to the number of spectra
(<code>NA_real_</code> if not present/defined), <code>collisionEnergy&lt;-</code> takes a
<code>numeric</code> of length equal to the number of spectra in <code>object</code>.</p></li>
<li><p><code>coreSpectraVariables()</code>: returns the <em>core</em> spectra variables along with
their expected data type.</p></li>
<li><p><code>dataOrigin()</code>, <code>dataOrigin&lt;-</code>: gets or sets the <em>data origin</em> for each
spectrum. <code>dataOrigin()</code> returns a <code>character</code> vector (same length than
<code>object</code>) with the origin of the spectra. <code>dataOrigin&lt;-</code> expects a
<code>character</code> vector (same length than <code>object</code>) with the replacement
values for the data origin of each spectrum.</p></li>
<li><p><code>dataStorage()</code>: returns a <code>character</code> vector (same length than <code>object</code>)
with the data storage location of each spectrum.</p></li>
<li><p><code>intensity()</code>: gets the intensity values from the spectra. Returns
a <code><a href="https://rdrr.io/pkg/IRanges/man/AtomicList-class.html" class="external-link">IRanges::NumericList()</a></code> of <code>numeric</code> vectors (intensity values for each
spectrum). The length of the list is equal to the number of
<code>spectra</code> in <code>object</code>.</p></li>
<li><p><code>ionCount()</code>: returns a <code>numeric</code> with the sum of intensities for
each spectrum. If the spectrum is empty (see <code>isEmpty()</code>),
<code>NA_real_</code> is returned.</p></li>
<li><p><code>isCentroided()</code>: a heuristic approach assessing if the spectra in
<code>object</code> are in profile or centroided mode. The function takes
the <code>qtl</code>th quantile top peaks, then calculates the difference
between adjacent m/z value and returns <code>TRUE</code> if the first
quartile is greater than <code>k</code>. (See <code>Spectra:::.isCentroided()</code> for
the code.)</p></li>
<li><p><code>isEmpty()</code>: checks whether a spectrum in <code>object</code> is empty
(i.e. does not contain any peaks). Returns a <code>logical</code> vector of
length equal number of spectra.</p></li>
<li><p><code>isolationWindowLowerMz()</code>, <code>isolationWindowLowerMz&lt;-</code>: gets or sets the
lower m/z boundary of the isolation window.</p></li>
<li><p><code>isolationWindowTargetMz()</code>, <code>isolationWindowTargetMz&lt;-</code>: gets or sets the
target m/z of the isolation window.</p></li>
<li><p><code>isolationWindowUpperMz()</code>, <code>isolationWindowUpperMz&lt;-</code>: gets or sets the
upper m/z boundary of the isolation window.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>: gets the number of spectra in the object.</p></li>
<li><p><code>lengths()</code>: gets the number of peaks (m/z-intensity values) per
spectrum. Returns an <code>integer</code> vector (length equal to the
number of spectra). For empty spectra, <code>0</code> is returned.</p></li>
<li><p><code>msLevel()</code>: gets the spectra's MS level. Returns an integer vector (names
being spectrum names, length equal to the number of spectra) with the MS
level for each spectrum.</p></li>
<li><p><code>mz()</code>: gets the mass-to-charge ratios (m/z) from the
spectra. Returns a <code><a href="https://rdrr.io/pkg/IRanges/man/AtomicList-class.html" class="external-link">IRanges::NumericList()</a></code> or length equal to the number
of spectra, each element a <code>numeric</code> vector with the m/z values of
one spectrum.</p></li>
<li><p><code>peaksData()</code>: gets the <em>peaks</em> data for all spectra in <code>object</code>. Peaks
data consist of the m/z and intensity values as well as possible additional
annotations (variables) of all peaks of each spectrum. The function
returns a <code><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">S4Vectors::SimpleList()</a></code> of two dimensional arrays (either
<code>matrix</code> or <code>data.frame</code>), with each array providing the values for the
requested <em>peak variables</em> (by default <code>"mz"</code> and <code>"intensity"</code>).
Optional parameter <code>columns</code> is passed to the backend's <code>peaksData()</code>
function to allow the selection of specific (or additional) peaks
variables (columns) that should be extracted (if available). Importantly,
it is <strong>not</strong> guaranteed that each backend supports this parameter (while
each backend must support extraction of <code>"mz"</code> and <code>"intensity"</code> columns).
Parameter <code>columns</code> defaults to <code>c("mz", "intensity")</code> but any value
returned by <code>peaksVariables(object)</code> is supported.
Note also that it is possible to extract the peak data with
<code>as(x, "list")</code> and <code>as(x, "SimpleList")</code> as a <code>list</code> and <code>SimpleList</code>,
respectively. Note however that, in contrast to <code>peaksData()</code>, <code>as()</code>
does not support the parameter <code>columns</code>.</p></li>
<li><p><code>peaksVariables()</code>: lists the available variables for mass peaks provided
by the backend. Default peak variables are <code>"mz"</code> and <code>"intensity"</code> (which
all backends need to support and provide), but some backends might provide
additional variables.
These variables correspond to the column names of the peak data array
returned by <code>peaksData()</code>.</p></li>
<li><p><code>polarity()</code>, <code>polarity&lt;-</code>: gets or sets the polarity for each
spectrum. <code>polarity()</code> returns an <code>integer</code> vector (length equal
to the number of spectra), with <code>0</code> and <code>1</code> representing negative
and positive polarities, respectively. <code>polarity&lt;-</code> expects an
<code>integer</code> vector of length 1 or equal to the number of spectra.</p></li>
<li><p><code>precursorCharge()</code>, <code>precursorIntensity()</code>, <code>precursorMz()</code>,
<code>precScanNum()</code>, <code>precAcquisitionNum()</code>: gets the charge (<code>integer</code>),
intensity (<code>numeric</code>), m/z (<code>numeric</code>), scan index (<code>integer</code>)
and acquisition number (<code>interger</code>) of the precursor for MS level &gt;
2 spectra from the object. Returns a vector of length equal to
the number of spectra in <code>object</code>. <code>NA</code> are reported for MS1
spectra of if no precursor information is available.</p></li>
<li><p><code>rtime()</code>, <code>rtime&lt;-</code>: gets or sets the retention times (in seconds)
for each spectrum.  <code>rtime()</code> returns a <code>numeric</code> vector (length
equal to the number of spectra) with the retention time for each
spectrum.  <code>rtime&lt;-</code> expects a numeric vector with length equal
to the number of spectra.</p></li>
<li><p><code>scanIndex()</code>: returns an <code>integer</code> vector with the <em>scan index</em>
for each spectrum. This represents the relative index of the
spectrum within each file. Note that this can be different to the
<code>acquisitionNum</code> of the spectrum which represents the index of the
spectrum during acquisition/measurement (as reported in the mzML file).</p></li>
<li><p><code>smoothed()</code>,<code>smoothed&lt;-</code>: gets or sets whether a spectrum is
<em>smoothed</em>. <code>smoothed()</code> returns a <code>logical</code> vector of length equal
to the number of spectra. <code>smoothed&lt;-</code> takes a <code>logical</code> vector
of length 1 or equal to the number of spectra in <code>object</code>.</p></li>
<li><p><code>spectraData()</code>: gets general spectrum metadata (annotation, also called
header). <code>spectraData()</code> returns a <code>DataFrame</code>. Note that this
method does by default <strong>not</strong> return m/z or intensity values.</p></li>
<li><p><code>spectraData&lt;-</code>: <strong>replaces</strong> the full spectra data of the <code>Spectra</code>
object with the one provided with <code>value</code>. The <code>spectraData&lt;-</code> function
expects a <code>DataFrame</code> to be passed as value with the same number of rows
as there a spectra in <code>object</code>. Note that replacing values of
peaks variables is not supported with a non-empty processing queue, i.e.
if any filtering or data manipulations on the peaks data was performed.
In these cases <code><a href="addProcessing.html">applyProcessing()</a></code> needs to be called first to apply all
cached data operations and empty the processing queue.</p></li>
<li><p><code>spectraNames()</code>, <code>spectraNames&lt;-</code>: gets or sets the spectra names.</p></li>
<li><p><code>spectraVariables()</code>: returns a <code>character</code> vector with the
available spectra variables (columns, fields or attributes of each
spectrum) available in <code>object</code>. Note that <code>spectraVariables()</code> does not
list the <em>peak variables</em> (<code>"mz"</code>, <code>"intensity"</code> and eventual additional
annotations for each MS peak). Peak variables are returned by
<code>peaksVariables()</code>.</p></li>
<li><p><code>tic()</code>: gets the total ion current/count (sum of signal of a
spectrum) for all spectra in <code>object</code>. By default, the value
reported in the original raw data file is returned. For an empty
spectrum, <code>0</code> is returned.</p></li>
<li><p><code>uniqueMsLevels()</code>: get the unique MS levels available in <code>object</code>. This
function is supposed to be more efficient than <code>unique(msLevel(object))</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="addProcessing.html">addProcessing()</a></code> for functions to analyze <code>Spectra</code>.</p></li>
<li><p><a href="Spectra.html">Spectra</a> for a general description of the <code>Spectra</code> object.</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Gibb, Johannes Rainer, Laurent Gatto, Philippine Louail</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a Spectra from mzML files and use the `MsBackendMzR` on-disk</span></span></span>
<span class="r-in"><span><span class="co">## backend.</span></span></span>
<span class="r-in"><span><span class="va">sciex_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sciex"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sciex</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectra.html">Spectra</a></span><span class="op">(</span><span class="va">sciex_file</span>, backend <span class="op">=</span> <span class="fu"><a href="MsBackend.html">MsBackendMzR</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sciex</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 1862 spectra in a MsBackendMzR backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            1     0.280         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            1     0.559         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            1     0.838         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            1     1.117         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            1     1.396         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...        ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1858         1   258.636       927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1859         1   258.915       928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1860         1   259.194       929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1861         1   259.473       930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1862         1   259.752       931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 34 more variables/columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> file(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20171016_POOL_POS_1_105-134.mzML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20171016_POOL_POS_3_105-134.mzML</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the number of spectra in the data set</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sciex</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1862</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the number of mass peaks per spectrum - limit to the first 6</span></span></span>
<span class="r-in"><span><span class="fu">lengths</span><span class="op">(</span><span class="va">sciex</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  578 1529 1600 1664 1417 1602</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the MS level for each spectrum - limit to the first 6 spectra</span></span></span>
<span class="r-in"><span><span class="fu">msLevel</span><span class="op">(</span><span class="va">sciex</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1 1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, we could also use $ to access a specific spectra variable.</span></span></span>
<span class="r-in"><span><span class="co">## This could also be used to add additional spectra variables to the</span></span></span>
<span class="r-in"><span><span class="co">## object (see further below).</span></span></span>
<span class="r-in"><span><span class="va">sciex</span><span class="op">$</span><span class="va">msLevel</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1 1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the intensity and m/z values.</span></span></span>
<span class="r-in"><span><span class="fu">intensity</span><span class="op">(</span><span class="va">sciex</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 1862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 0 412 0 0 412 0 0 412 0 0 412 0 0 ... 0 412 0 0 412 0 0 412 0 0 412 412 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] 0 140 0 0 140 0 0 419 0 0 140 0 0 ... 0 140 0 0 140 0 0 140 0 0 279 140 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]] 0 132 263 263 132 132 0 0 132 132 0 0 ... 0 0 132 0 0 132 0 0 132 0 132 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]] 0 139 139 0 0 139 0 0 139 139 0 139 0 ... 0 0 139 0 0 277 0 0 139 0 139 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]] 0 164 0 0 328 0 164 0 0 164 0 0 164 ... 164 0 0 164 0 0 164 0 164 0 328 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]] 0 146 146 146 0 0 146 0 0 146 0 0 ... 146 0 0 146 146 0 0 146 0 0 146 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[7]] 0 296 0 296 0 0 148 0 0 148 0 0 148 ... 0 0 148 0 0 148 0 0 148 0 0 148 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[8]] 0 170 0 170 170 170 0 170 0 0 170 0 ... 170 0 0 170 0 0 170 0 0 170 170 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[9]] 0 157 0 314 0 0 157 0 0 157 0 0 314 ... 0 0 157 0 0 157 0 0 157 0 157 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[10]] 0 151 302 302 604 0 302 0 0 151 0 0 ... 151 0 0 151 0 151 0 151 0 151 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;1852 more elements&gt;</span>
<span class="r-in"><span><span class="fu">mz</span><span class="op">(</span><span class="va">sciex</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 1862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 105.043454833354 105.044900379521 ... 133.982027457992 133.983660012089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] 105.027517517902 105.028962955892 ... 133.982017159657 133.98364971537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]] 105.037635723077 105.03908123069 ... 133.988547442185 133.990180037683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]] 105.037635723077 105.03908123069 ... 133.98364971537 133.985282281029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]] 105.034744757582 105.036190245303 ... 133.986914856634 133.988547442185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]] 105.041972245917 105.043417783368 ... 133.982017159657 133.98364971537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[7]] 105.037635723077 105.03908123069 ... 133.996710519135 133.998343164363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[8]] 105.034744757582 105.036190245303 ... 133.980384613891 133.982017159657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[9]] 105.040526728357 105.041972255863 ... 133.97875207807 133.980384613891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[10]] 105.036190235357 105.037635733023 ... 133.985282281029 133.986914856634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;1852 more elements&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Convert a subset of the Spectra object to a long DataFrame.</span></span></span>
<span class="r-in"><span><span class="fu">asDataFrame</span><span class="op">(</span><span class="va">sciex</span>, i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, spectraVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rtime"</span>, <span class="st">"msLevel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 3707 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             mz intensity     rtime   msLevel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      105.043         0      0.28         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      105.045       412      0.28         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      105.046         0      0.28         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      107.055         0      0.28         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      107.057       412      0.28         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...        ...       ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3703   133.984         0     0.838         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3704   133.985       132     0.838         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3705   133.987         0     0.838         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3706   133.989       132     0.838         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3707   133.990         0     0.838         1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a Spectra providing a `DataFrame` containing the spectrum data.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span>, rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spd</span><span class="op">$</span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">103.2</span>, <span class="fl">104.3</span>, <span class="fl">106.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45.6</span>, <span class="fl">120.4</span>, <span class="fl">190.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spd</span><span class="op">$</span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">34.2</span>, <span class="fl">17</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.3</span>, <span class="fl">15.2</span>, <span class="fl">6.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectra.html">Spectra</a></span><span class="op">(</span><span class="va">spd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSn data (Spectra) with 2 spectra in a MsBackendMemory backend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msLevel     rtime scanIndex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1       1.1        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2       1.2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ... 16 more variables/columns.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## List all available spectra variables (i.e. spectrum data and metadata).</span></span></span>
<span class="r-in"><span><span class="fu">spectraVariables</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "msLevel"                 "rtime"                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "acquisitionNum"          "scanIndex"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "dataStorage"             "dataOrigin"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "centroided"              "smoothed"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "polarity"                "precScanNum"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "precursorMz"             "precursorIntensity"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "precursorCharge"         "collisionEnergy"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "isolationWindowLowerMz"  "isolationWindowTargetMz"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "isolationWindowUpperMz" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## For all *core* spectrum variables accessor functions are available. These</span></span></span>
<span class="r-in"><span><span class="co">## return NA if the variable was not set.</span></span></span>
<span class="r-in"><span><span class="fu">centroided</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA NA</span>
<span class="r-in"><span><span class="fu">dataStorage</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "&lt;memory&gt;" "&lt;memory&gt;"</span>
<span class="r-in"><span><span class="fu">rtime</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.1 1.2</span>
<span class="r-in"><span><span class="fu">precursorMz</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The core spectra variables are:</span></span></span>
<span class="r-in"><span><span class="fu">coreSpectraVariables</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 msLevel                   rtime          acquisitionNum </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               "integer"               "numeric"               "integer" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               scanIndex                      mz               intensity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               "integer"           "NumericList"           "NumericList" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             dataStorage              dataOrigin              centroided </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "character"             "character"               "logical" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                smoothed                polarity             precScanNum </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               "logical"               "integer"               "integer" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             precursorMz      precursorIntensity         precursorCharge </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               "numeric"               "numeric"               "integer" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         collisionEnergy  isolationWindowLowerMz isolationWindowTargetMz </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               "numeric"               "numeric"               "numeric" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  isolationWindowUpperMz </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               "numeric" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add an additional metadata column.</span></span></span>
<span class="r-in"><span><span class="va">s</span><span class="op">$</span><span class="va">spectrum_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp_1"</span>, <span class="st">"sp_2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## List spectra variables, "spectrum_id" is now also listed</span></span></span>
<span class="r-in"><span><span class="fu">spectraVariables</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "msLevel"                 "rtime"                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "acquisitionNum"          "scanIndex"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "dataStorage"             "dataOrigin"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "centroided"              "smoothed"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "polarity"                "precScanNum"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "precursorMz"             "precursorIntensity"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "precursorCharge"         "collisionEnergy"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "isolationWindowLowerMz"  "isolationWindowTargetMz"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "isolationWindowUpperMz"  "spectrum_id"            </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the values for the new spectra variable</span></span></span>
<span class="r-in"><span><span class="va">s</span><span class="op">$</span><span class="va">spectrum_id</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sp_1" "sp_2"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract specific spectra variables.</span></span></span>
<span class="r-in"><span><span class="fu">spectraData</span><span class="op">(</span><span class="va">s</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spectrum_id"</span>, <span class="st">"msLevel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 2 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   spectrum_id   msLevel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        sp_1         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        sp_2         2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##  --------  PEAKS VARIABLES AND DATA  --------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get the peak data (m/z and intensity values).</span></span></span>
<span class="r-in"><span><span class="va">pks</span> <span class="op">&lt;-</span> <span class="fu">peaksData</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pks</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of length 2</span>
<span class="r-in"><span><span class="va">pks</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.0     200.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 103.2     400.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 104.3      34.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 106.5      17.0</span>
<span class="r-in"><span><span class="va">pks</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  45.6      12.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 120.4      15.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 190.2       6.8</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note that we could get the same resulb by coercing the `Spectra` to</span></span></span>
<span class="r-in"><span><span class="co">## a `list` or `SimpleList`:</span></span></span>
<span class="r-in"><span><span class="fu">as</span><span class="op">(</span><span class="va">s</span>, <span class="st">"list"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 100.0     200.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 103.2     400.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 104.3      34.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 106.5      17.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  45.6      12.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 120.4      15.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 190.2       6.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">as</span><span class="op">(</span><span class="va">s</span>, <span class="st">"SimpleList"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of length 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Or use `mz()` and `intensity()` to extract the m/z and intensity values</span></span></span>
<span class="r-in"><span><span class="co">## separately</span></span></span>
<span class="r-in"><span><span class="fu">mz</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 100 103.2 104.3 106.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] 45.6 120.4 190.2</span>
<span class="r-in"><span><span class="fu">intensity</span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NumericList of length 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]] 200 400 34.2 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]] 12.3 15.2 6.8</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Some `MsBackend` classes provide support for arbitrary peaks variables</span></span></span>
<span class="r-in"><span><span class="co">## (in addition to the mandatory `"mz"` and `"intensity"` values. Below</span></span></span>
<span class="r-in"><span><span class="co">## we create a simple data frame with an additional peak variable `"pk_ann"`</span></span></span>
<span class="r-in"><span><span class="co">## and create a `Spectra` with a `MsBackendMemory` for that data.</span></span></span>
<span class="r-in"><span><span class="co">## Importantly the number of values (per spectrum) need to be the same</span></span></span>
<span class="r-in"><span><span class="co">## for all peak variables.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span><span class="op">)</span>, rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123.2</span>, <span class="fl">123.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmp</span><span class="op">$</span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">103.1</span>, <span class="fl">110.4</span>, <span class="fl">303.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">343.2</span>, <span class="fl">453.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmp</span><span class="op">$</span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">130.1</span>, <span class="fl">543.1</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.45</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmp</span><span class="op">$</span><span class="va">pk_ann</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA_character_</span>, <span class="st">"A"</span>, <span class="st">"P"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create the Spectra. With parameter `peaksVariables` we can define</span></span></span>
<span class="r-in"><span><span class="co">## the columns in `tmp` that contain peaks variables.</span></span></span>
<span class="r-in"><span><span class="va">sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="Spectra.html">Spectra</a></span><span class="op">(</span><span class="va">tmp</span>, source <span class="op">=</span> <span class="fu"><a href="MsBackend.html">MsBackendMemory</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    peaksVariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"intensity"</span>, <span class="st">"pk_ann"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">peaksVariables</span><span class="op">(</span><span class="va">sps</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mz"        "intensity" "pk_ann"   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract just the m/z and intensity values</span></span></span>
<span class="r-in"><span><span class="fu">peaksData</span><span class="op">(</span><span class="va">sps</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mz intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 103.1     130.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 110.4     543.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 303.1      40.0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract the full peaks data</span></span></span>
<span class="r-in"><span><span class="fu">peaksData</span><span class="op">(</span><span class="va">sps</span>, columns <span class="op">=</span> <span class="fu">peaksVariables</span><span class="op">(</span><span class="va">sps</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mz intensity pk_ann</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 103.1     130.1   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 110.4     543.1      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 303.1      40.0      P</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Access just the pk_ann variable</span></span></span>
<span class="r-in"><span><span class="va">sps</span><span class="op">$</span><span class="va">pk_ann</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA  "A" "P"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "B" "P"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto, Johannes Rainer, Sebastian Gibb, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

